> Sys.setlocale("LC_COLLATE", "C")
[1] "C"
> Sys.setlocale("LC_TIME", "C")
[1] "C"
> Sys.setenv(TZ='EST') # so that tests that print out time zone work everywhere
> options(error = function() NULL, showErrorCalls = FALSE, warn=1)
> dow <- function(x) if (!is.null(x)) { x <- dateParse(x); paste(format(x, "%Y/%m/%d"), " (", weekdays(x, T), ")", sep = "") } else ""
> span <- function(x, len) { res <- rep("                ", len); res[1:length(x)] <- x; res}
> pp <- function(x, y = NULL) if (length(x) == length(y)) cat(paste(dow(x), "->", dow(y), "\n"), sep = "") else { len <- max(length(x), length(y)); cat(paste(span(dow(x), len), "  ", span(dow(y), len), "\n"), sep = "") }
> pp(dateWarp("2001/04/20", -1:3, by = "days"))
2001/04/19 (Thu)     
2001/04/20 (Fri)                     
2001/04/21 (Sat)                     
2001/04/22 (Sun)                     
2001/04/23 (Mon)                     
> pp(dateWarp("2001/04/20", -1:3, by = "days", direction = -1))
2001/04/21 (Sat)     
2001/04/20 (Fri)                     
2001/04/19 (Thu)                     
2001/04/18 (Wed)                     
2001/04/17 (Tue)                     
> pp(dateWarp("2001/04/20", -1:3, by = "bizdays"))
2001/04/19 (Thu)     
2001/04/20 (Fri)                     
2001/04/23 (Mon)                     
2001/04/24 (Tue)                     
2001/04/25 (Wed)                     
> pp(dateWarp("2001/04/20", -1:3, by = "bizdays", direction = -1))
2001/04/23 (Mon)     
2001/04/20 (Fri)                     
2001/04/19 (Thu)                     
2001/04/18 (Wed)                     
2001/04/17 (Tue)                     
> pp(dateWarp("2001/1/5", -2:3, by = "weeks"))
2000/12/22 (Fri)     
2000/12/29 (Fri)                     
2001/01/05 (Fri)                     
2001/01/12 (Fri)                     
2001/01/19 (Fri)                     
2001/01/26 (Fri)                     
> pp(dateWarp("2001/1/5", -2:3, by = "weeks", direction = -1))
2001/01/19 (Fri)     
2001/01/12 (Fri)                     
2001/01/05 (Fri)                     
2000/12/29 (Fri)                     
2000/12/22 (Fri)                     
2000/12/15 (Fri)                     
> pp(dateWarp("2001/04/20", -4:9, by = "months"))
2000/12/20 (Wed)     
2001/01/20 (Sat)                     
2001/02/20 (Tue)                     
2001/03/20 (Tue)                     
2001/05/01 (Tue)                     
2001/05/20 (Sun)                     
2001/06/20 (Wed)                     
2001/07/20 (Fri)                     
2001/08/20 (Mon)                     
2001/09/20 (Thu)                     
2001/10/20 (Sat)                     
2001/11/20 (Tue)                     
2001/12/20 (Thu)                     
2002/01/20 (Sun)                     
> pp(dateWarp("2001/04/20", -4:9, by = "months", direction = -1))
2001/08/20 (Mon)     
2001/07/20 (Fri)                     
2001/06/20 (Wed)                     
2001/05/20 (Sun)                     
2001/04/01 (Sun)                     
2001/03/20 (Tue)                     
2001/02/20 (Tue)                     
2001/01/20 (Sat)                     
2000/12/20 (Wed)                     
2000/11/20 (Mon)                     
2000/10/20 (Fri)                     
2000/09/20 (Wed)                     
2000/08/20 (Sun)                     
2000/07/20 (Thu)                     
> pp(dateWarp("2001/04/20", -1:3, by = "years"))
2000/04/20 (Thu)     
2002/01/01 (Tue)                     
2002/04/20 (Sat)                     
2003/04/20 (Sun)                     
2004/04/20 (Tue)                     
> pp(dateWarp("2001/04/20", -1:3, by = "years", direction = -1))
2002/04/20 (Sat)     
2001/01/01 (Mon)                     
2000/04/20 (Thu)                     
1999/04/20 (Tue)                     
1998/04/20 (Mon)                     
> # x1 omits holidays
> library(Holidays)
#@ ignore-output
> x1 <- dateSeq("2001/12/20", by = 'bizdays', len = 9, holidays = "NYSEC")
> pp(x1)
2001/12/20 (Thu)     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
> # x2 has holidays and weekends in it
> x2 <- dateSeq("2001/12/23", by = 'days',len = 11, holidays = NULL)
> pp(x2)
2001/12/23 (Sun)     
2001/12/24 (Mon)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/29 (Sat)                     
2001/12/30 (Sun)                     
2001/12/31 (Mon)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
> pp(x1, dateWarp(x1, -1:1, by = "bizdays", duplicates.keep = FALSE))
2001/12/20 (Thu)    2001/12/19 (Wed) 
2001/12/21 (Fri)    2001/12/20 (Thu) 
2001/12/24 (Mon)    2001/12/21 (Fri) 
2001/12/26 (Wed)    2001/12/25 (Tue) 
2001/12/27 (Thu)    2001/12/26 (Wed) 
2001/12/28 (Fri)    2001/12/27 (Thu) 
2001/12/31 (Mon)    2001/12/28 (Fri) 
2002/01/02 (Wed)    2002/01/01 (Tue) 
2002/01/03 (Thu)    2002/01/02 (Wed) 
                    2001/12/24 (Mon) 
                    2001/12/31 (Mon) 
                    2002/01/03 (Thu) 
                    2002/01/04 (Fri) 
> pp(x2, dateWarp(x2, -1:1, by = "bizdays", duplicates.keep = FALSE))
2001/12/23 (Sun)    2001/12/21 (Fri) 
2001/12/24 (Mon)    2001/12/24 (Mon) 
2001/12/25 (Tue)    2001/12/25 (Tue) 
2001/12/26 (Wed)    2001/12/26 (Wed) 
2001/12/27 (Thu)    2001/12/27 (Thu) 
2001/12/28 (Fri)    2001/12/28 (Fri) 
2001/12/29 (Sat)    2001/12/31 (Mon) 
2001/12/30 (Sun)    2002/01/01 (Tue) 
2001/12/31 (Mon)    2002/01/02 (Wed) 
2002/01/01 (Tue)    2002/01/03 (Thu) 
2002/01/02 (Wed)                     
> pp(x1, dateWarp(x1, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/20 (Thu)    2001/12/19 (Wed) 
2001/12/21 (Fri)    2001/12/20 (Thu) 
2001/12/24 (Mon)    2001/12/21 (Fri) 
2001/12/26 (Wed)    2001/12/24 (Mon) 
2001/12/27 (Thu)    2001/12/26 (Wed) 
2001/12/28 (Fri)    2001/12/27 (Thu) 
2001/12/31 (Mon)    2001/12/28 (Fri) 
2002/01/02 (Wed)    2001/12/31 (Mon) 
2002/01/03 (Thu)    2002/01/02 (Wed) 
                    2002/01/03 (Thu) 
                    2002/01/04 (Fri) 
> pp(x2, dateWarp(x2, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/23 (Sun)    2001/12/21 (Fri) 
2001/12/24 (Mon)    2001/12/24 (Mon) 
2001/12/25 (Tue)    2001/12/26 (Wed) 
2001/12/26 (Wed)    2001/12/27 (Thu) 
2001/12/27 (Thu)    2001/12/28 (Fri) 
2001/12/28 (Fri)    2001/12/31 (Mon) 
2001/12/29 (Sat)    2002/01/02 (Wed) 
2001/12/30 (Sun)    2002/01/03 (Thu) 
2001/12/31 (Mon)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
> pp(x1, dateWarp(x1, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/20 (Thu)    2001/12/19 (Wed) 
2001/12/21 (Fri)    2001/12/20 (Thu) 
2001/12/24 (Mon)    2001/12/21 (Fri) 
2001/12/26 (Wed)    2001/12/24 (Mon) 
2001/12/27 (Thu)    2001/12/26 (Wed) 
2001/12/28 (Fri)    2001/12/27 (Thu) 
2001/12/31 (Mon)    2001/12/28 (Fri) 
2002/01/02 (Wed)    2001/12/31 (Mon) 
2002/01/03 (Thu)    2002/01/02 (Wed) 
                    2002/01/03 (Thu) 
                    2002/01/04 (Fri) 
> pp(dateWarp("2001/12/25", -1:1, holidays = "NYSEC", by = "bizdays", duplicates.keep = TRUE))
2001/12/24 (Mon)     
2001/12/26 (Wed)                     
2001/12/26 (Wed)                     
> # test "unique" functionality
> pp(dateWarp(x1, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = TRUE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp(x1, -1:1, by = "bizdays", duplicates.keep = FALSE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
2001/12/24 (Mon)                     
2001/12/31 (Mon)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp(x2, -1:1, by = "bizdays", duplicates.keep = FALSE))
2001/12/21 (Fri)     
2001/12/24 (Mon)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
> pp(dateWarp(x1, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp(x2, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/21 (Fri)     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
> pp(dateWarp(x1, -1:1, by = "bizdays", holidays = "NYSEC", duplicates.keep = FALSE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp("2001/12/25", -1:1, holidays = "NYSEC", by = "bizdays", duplicates.keep = FALSE))
2001/12/24 (Mon)     
2001/12/26 (Wed)                     
> # test "holidays" functionality
> pp(dateWarp("2001/12/25", -1, by = "bizdays", holidays = "NYSEC"))
2001/12/24 (Mon)     
> # given an out-of-order shift, dateWarp will produce out of order dates
> pp(dateWarp("2001/12/25", 1:-2, by = "bizdays", duplicates.keep = TRUE))
2001/12/26 (Wed)     
2001/12/25 (Tue)                     
2001/12/24 (Mon)                     
2001/12/21 (Fri)                     
> # test non-trivial spec arguments.
> pp(dateWarp("2001/04/20", list(shift = -1:3), by = "days"))
2001/04/19 (Thu)     
2001/04/20 (Fri)                     
2001/04/21 (Sat)                     
2001/04/22 (Sun)                     
2001/04/23 (Mon)                     
> x3 <- as.Date("2009/1/1") + -5:5
> pp(x3, dateWarp(x3, "+1 bizdays@NYSEC"))
2008/12/27 (Sat) -> 2008/12/29 (Mon) 
2008/12/28 (Sun) -> 2008/12/29 (Mon) 
2008/12/29 (Mon) -> 2008/12/30 (Tue) 
2008/12/30 (Tue) -> 2008/12/31 (Wed) 
2008/12/31 (Wed) -> 2009/01/02 (Fri) 
2009/01/01 (Thu) -> 2009/01/02 (Fri) 
2009/01/02 (Fri) -> 2009/01/05 (Mon) 
2009/01/03 (Sat) -> 2009/01/05 (Mon) 
2009/01/04 (Sun) -> 2009/01/05 (Mon) 
2009/01/05 (Mon) -> 2009/01/06 (Tue) 
2009/01/06 (Tue) -> 2009/01/07 (Wed) 
> pp(x3, dateWarp(x3, "+1 NYSEC"))
#@ ignore-linebreaks
Error in dateWarp.Date(x3, "+1 NYSEC") : 
  'by' must contain only the values 'days', 'bizdays','weeks', 'months' or 'years'.
> pp(x3, dateWarp(x3, "+1 bizdays"))
2008/12/27 (Sat) -> 2008/12/29 (Mon) 
2008/12/28 (Sun) -> 2008/12/29 (Mon) 
2008/12/29 (Mon) -> 2008/12/30 (Tue) 
2008/12/30 (Tue) -> 2008/12/31 (Wed) 
2008/12/31 (Wed) -> 2009/01/01 (Thu) 
2009/01/01 (Thu) -> 2009/01/02 (Fri) 
2009/01/02 (Fri) -> 2009/01/05 (Mon) 
2009/01/03 (Sat) -> 2009/01/05 (Mon) 
2009/01/04 (Sun) -> 2009/01/05 (Mon) 
2009/01/05 (Mon) -> 2009/01/06 (Tue) 
2009/01/06 (Tue) -> 2009/01/07 (Wed) 
> pp(x3, dateWarp(x3, "-1 days"))
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/27 (Sat) 
2008/12/29 (Mon) -> 2008/12/28 (Sun) 
2008/12/30 (Tue) -> 2008/12/29 (Mon) 
2008/12/31 (Wed) -> 2008/12/30 (Tue) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/01 (Thu) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
2009/01/04 (Sun) -> 2009/01/03 (Sat) 
2009/01/05 (Mon) -> 2009/01/04 (Sun) 
2009/01/06 (Tue) -> 2009/01/05 (Mon) 
> pp(x3, dateWarp(x3, "-2", by='bizdays'))
2008/12/27 (Sat) -> 2008/12/25 (Thu) 
2008/12/28 (Sun) -> 2008/12/25 (Thu) 
2008/12/29 (Mon) -> 2008/12/25 (Thu) 
2008/12/30 (Tue) -> 2008/12/26 (Fri) 
2008/12/31 (Wed) -> 2008/12/29 (Mon) 
2009/01/01 (Thu) -> 2008/12/30 (Tue) 
2009/01/02 (Fri) -> 2008/12/31 (Wed) 
2009/01/03 (Sat) -> 2009/01/01 (Thu) 
2009/01/04 (Sun) -> 2009/01/01 (Thu) 
2009/01/05 (Mon) -> 2009/01/01 (Thu) 
2009/01/06 (Tue) -> 2009/01/02 (Fri) 
> pp(x3, dateWarp(x3, -3, by='bizdays'))
2008/12/27 (Sat) -> 2008/12/24 (Wed) 
2008/12/28 (Sun) -> 2008/12/24 (Wed) 
2008/12/29 (Mon) -> 2008/12/24 (Wed) 
2008/12/30 (Tue) -> 2008/12/25 (Thu) 
2008/12/31 (Wed) -> 2008/12/26 (Fri) 
2009/01/01 (Thu) -> 2008/12/29 (Mon) 
2009/01/02 (Fri) -> 2008/12/30 (Tue) 
2009/01/03 (Sat) -> 2008/12/31 (Wed) 
2009/01/04 (Sun) -> 2008/12/31 (Wed) 
2009/01/05 (Mon) -> 2008/12/31 (Wed) 
2009/01/06 (Tue) -> 2009/01/01 (Thu) 
> pp(x3, dateWarp(x3))
#@ ignore-linebreaks
Error in dateWarp.Date(x3) : 'spec' argument missing.
> pp(x3, dateWarp(x3, list("-3 days", shift = "+2 days", "-1 days", "+3 days")))
2008/12/27 (Sat) -> 2008/12/28 (Sun) 
2008/12/28 (Sun) -> 2008/12/29 (Mon) 
2008/12/29 (Mon) -> 2008/12/30 (Tue) 
2008/12/30 (Tue) -> 2008/12/31 (Wed) 
2008/12/31 (Wed) -> 2009/01/01 (Thu) 
2009/01/01 (Thu) -> 2009/01/02 (Fri) 
2009/01/02 (Fri) -> 2009/01/03 (Sat) 
2009/01/03 (Sat) -> 2009/01/04 (Sun) 
2009/01/04 (Sun) -> 2009/01/05 (Mon) 
2009/01/05 (Mon) -> 2009/01/06 (Tue) 
2009/01/06 (Tue) -> 2009/01/07 (Wed) 
> pp(dateWarp(x1, list(-1:1, unique = 0), by = "bizdays", duplicates.keep = TRUE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
2001/12/24 (Mon)                     
2001/12/31 (Mon)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp(x1, list(-1:1, unique = T), by = "bizdays", duplicates.keep = TRUE))
2001/12/19 (Wed)     
2001/12/20 (Thu)                     
2001/12/21 (Fri)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2002/01/01 (Tue)                     
2002/01/02 (Wed)                     
2001/12/24 (Mon)                     
2001/12/31 (Mon)                     
2002/01/03 (Thu)                     
2002/01/04 (Fri)                     
> pp(dateWarp(x1, list(latest = "2001/12/25"), by = "bizdays", duplicates.keep = TRUE))
2001/12/20 (Thu)     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
> pp(dateWarp(x1, list(latest = "2001/12/25"), by = "bizdays", duplicates.keep = FALSE))
2001/12/20 (Thu)     
2001/12/21 (Fri)                     
2001/12/24 (Mon)                     
2001/12/25 (Tue)                     
> pp(dateWarp(x1, list(earliest = "2001/12/25"), by = "bizdays", duplicates.keep = TRUE))
2001/12/25 (Tue)     
2001/12/25 (Tue)                     
2001/12/25 (Tue)                     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
> pp(dateWarp(x1, list(earliest = "2001/12/25"), by = "bizdays", duplicates.keep = FALSE))
2001/12/25 (Tue)     
2001/12/26 (Wed)                     
2001/12/27 (Thu)                     
2001/12/28 (Fri)                     
2001/12/31 (Mon)                     
2002/01/02 (Wed)                     
2002/01/03 (Thu)                     
> x4 <- as.Date("2009/1/1") + -5:5
> pp(x4, dateWarp(x4, list(align = list(by = "days", k.by = 3, direction = -1))))
2008/12/27 (Sat) -> 2008/12/25 (Thu) 
2008/12/28 (Sun) -> 2008/12/28 (Sun) 
2008/12/29 (Mon) -> 2008/12/28 (Sun) 
2008/12/30 (Tue) -> 2008/12/28 (Sun) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2009/01/01 (Thu) 
2009/01/02 (Fri) -> 2009/01/01 (Thu) 
2009/01/03 (Sat) -> 2009/01/01 (Thu) 
2009/01/04 (Sun) -> 2009/01/04 (Sun) 
2009/01/05 (Mon) -> 2009/01/04 (Sun) 
2009/01/06 (Tue) -> 2009/01/04 (Sun) 
> x5 <- as.Date("2009/1/1") + -8:2
> pp(x5, dateWarp(x5, list(align = list(by = "bizdays", k.by = 1, direction = -1, holidays = "NYSEC"))))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/24 (Wed) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/02 (Fri) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
> pp(x5, dateWarp(x5, list(align = list(by = "bizdays@NYSEC", k.by = 1, direction = -1, holidays = "NYSEC"))))
#@ ignore-linebreaks
Error in dateWarp.Date(x5, list(align = list(by = "bizdays@NYSEC", k.by = 1,  : 
  double specification of holidays in 'align' component.
> pp(x5, dateWarp(x5, list(align = list(by = "bizdays@NYSEC", k.by = 1, direction = -1))))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/24 (Wed) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/02 (Fri) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
> pp(x5, dateWarp(x5, list(align = list(by = "bizdays", k.by = 1, direction = -1, holidays = "NYSEC")), holidays = "JPNEX"))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/24 (Wed) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/02 (Fri) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
> pp(x5, dateWarp(x5, list(align = list(by = "bizdays", k.by = 1, direction = -1, holidays = "JPNEX")), holidays = "NYSEC"))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/25 (Thu) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/30 (Tue) 
2009/01/01 (Thu) -> 2008/12/30 (Tue) 
2009/01/02 (Fri) -> 2008/12/30 (Tue) 
2009/01/03 (Sat) -> 2008/12/30 (Tue) 
> date <- as.Date("2009/1/1") + -8:2; pp(date, dateWarp(date, list(align = list(k.by = 1, direction = -1, by = 'bizdays', holidays = "NYSEC"))))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/24 (Wed) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/02 (Fri) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
> date <- as.Date("2009/1/1") + -8:2; pp(date, dateWarp(date, list(align = list(k.by = 1, direction = -1, holidays = "NYSEC")), by = "bizdays"))
2008/12/24 (Wed) -> 2008/12/24 (Wed) 
2008/12/25 (Thu) -> 2008/12/24 (Wed) 
2008/12/26 (Fri) -> 2008/12/26 (Fri) 
2008/12/27 (Sat) -> 2008/12/26 (Fri) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/29 (Mon) 
2008/12/30 (Tue) -> 2008/12/30 (Tue) 
2008/12/31 (Wed) -> 2008/12/31 (Wed) 
2009/01/01 (Thu) -> 2008/12/31 (Wed) 
2009/01/02 (Fri) -> 2009/01/02 (Fri) 
2009/01/03 (Sat) -> 2009/01/02 (Fri) 
> x <- dateSeq("2001/01/01", len = 4, by = "weeks")
> x6 <- dateSeq("2001/01/01", len = 30, by = "bizdays")
> pp(dateWarp(x6, list(align = list(to = x, how = "before")), duplicates.keep = FALSE))
2001/01/01 (Mon)     
2001/01/08 (Mon)                     
2001/01/15 (Mon)                     
2001/01/22 (Mon)                     
> pp(dateWarp(x6, list(align = list(to = x, how = "after")), duplicates.keep = FALSE))
2001/01/01 (Mon)     
2001/01/08 (Mon)                     
2001/01/15 (Mon)                     
2001/01/22 (Mon)                     
NA (NA)                     
> pp(dateWarp(x6, list(align = list(to = x, how = "after")), duplicates.keep = TRUE))
2001/01/01 (Mon)     
2001/01/08 (Mon)                     
2001/01/08 (Mon)                     
2001/01/08 (Mon)                     
2001/01/08 (Mon)                     
2001/01/08 (Mon)                     
2001/01/15 (Mon)                     
2001/01/15 (Mon)                     
2001/01/15 (Mon)                     
2001/01/15 (Mon)                     
2001/01/15 (Mon)                     
2001/01/22 (Mon)                     
2001/01/22 (Mon)                     
2001/01/22 (Mon)                     
2001/01/22 (Mon)                     
2001/01/22 (Mon)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
NA (NA)                     
> pp(x3, dateWarp(x3, list(shift = list(by = "days", k.by = 7, direction = -1))))
2008/12/27 (Sat) -> 2008/12/20 (Sat) 
2008/12/28 (Sun) -> 2008/12/21 (Sun) 
2008/12/29 (Mon) -> 2008/12/22 (Mon) 
2008/12/30 (Tue) -> 2008/12/23 (Tue) 
2008/12/31 (Wed) -> 2008/12/24 (Wed) 
2009/01/01 (Thu) -> 2008/12/25 (Thu) 
2009/01/02 (Fri) -> 2008/12/26 (Fri) 
2009/01/03 (Sat) -> 2008/12/27 (Sat) 
2009/01/04 (Sun) -> 2008/12/28 (Sun) 
2009/01/05 (Mon) -> 2008/12/29 (Mon) 
2009/01/06 (Tue) -> 2008/12/30 (Tue) 
> pp(x3, dateWarp(x3, list(shift = list(by = "days", k.by = 7)))) 
2008/12/27 (Sat) -> 2009/01/03 (Sat) 
2008/12/28 (Sun) -> 2009/01/04 (Sun) 
2008/12/29 (Mon) -> 2009/01/05 (Mon) 
2008/12/30 (Tue) -> 2009/01/06 (Tue) 
2008/12/31 (Wed) -> 2009/01/07 (Wed) 
2009/01/01 (Thu) -> 2009/01/08 (Thu) 
2009/01/02 (Fri) -> 2009/01/09 (Fri) 
2009/01/03 (Sat) -> 2009/01/10 (Sat) 
2009/01/04 (Sun) -> 2009/01/11 (Sun) 
2009/01/05 (Mon) -> 2009/01/12 (Mon) 
2009/01/06 (Tue) -> 2009/01/13 (Tue) 
> pp(x3, dateWarp(x3, list(shift = list(by = "days")))) 
2008/12/27 (Sat) -> 2008/12/28 (Sun) 
2008/12/28 (Sun) -> 2008/12/29 (Mon) 
2008/12/29 (Mon) -> 2008/12/30 (Tue) 
2008/12/30 (Tue) -> 2008/12/31 (Wed) 
2008/12/31 (Wed) -> 2009/01/01 (Thu) 
2009/01/01 (Thu) -> 2009/01/02 (Fri) 
2009/01/02 (Fri) -> 2009/01/03 (Sat) 
2009/01/03 (Sat) -> 2009/01/04 (Sun) 
2009/01/04 (Sun) -> 2009/01/05 (Mon) 
2009/01/05 (Mon) -> 2009/01/06 (Tue) 
2009/01/06 (Tue) -> 2009/01/07 (Wed) 
> pp(x3, dateWarp(x3, list(shift = list(by = "days", 2)))) 
2008/12/27 (Sat) -> 2008/12/29 (Mon) 
2008/12/28 (Sun) -> 2008/12/30 (Tue) 
2008/12/29 (Mon) -> 2008/12/31 (Wed) 
2008/12/30 (Tue) -> 2009/01/01 (Thu) 
2008/12/31 (Wed) -> 2009/01/02 (Fri) 
2009/01/01 (Thu) -> 2009/01/03 (Sat) 
2009/01/02 (Fri) -> 2009/01/04 (Sun) 
2009/01/03 (Sat) -> 2009/01/05 (Mon) 
2009/01/04 (Sun) -> 2009/01/06 (Tue) 
2009/01/05 (Mon) -> 2009/01/07 (Wed) 
2009/01/06 (Tue) -> 2009/01/08 (Thu) 
> pp(x3, dateWarp(x3, list(shift = list(by = "days", 2)), direction = -2)) 
#@ ignore-linebreaks
Error in dateWarp.Date(x3, list(shift = list(by = "days", 2)), direction = -2) : 
  'direction' must be -1 or 1.
> pp(x3, dateWarp(x3, list(shift = list(by = "days", 2)), direction = -1)) 
2008/12/27 (Sat) -> 2008/12/25 (Thu) 
2008/12/28 (Sun) -> 2008/12/26 (Fri) 
2008/12/29 (Mon) -> 2008/12/27 (Sat) 
2008/12/30 (Tue) -> 2008/12/28 (Sun) 
2008/12/31 (Wed) -> 2008/12/29 (Mon) 
2009/01/01 (Thu) -> 2008/12/30 (Tue) 
2009/01/02 (Fri) -> 2008/12/31 (Wed) 
2009/01/03 (Sat) -> 2009/01/01 (Thu) 
2009/01/04 (Sun) -> 2009/01/02 (Fri) 
2009/01/05 (Mon) -> 2009/01/03 (Sat) 
2009/01/06 (Tue) -> 2009/01/04 (Sun) 
> pp(x1, dateWarp(x1, list(shift = list(by = "bizdays", k.by = 2, direction = 1, holidays = "NYSEC"), shift = 2), by = "days", direction = -1, holidays = "NONE"))
2001/12/20 (Thu) -> 2001/12/22 (Sat) 
2001/12/21 (Fri) -> 2001/12/24 (Mon) 
2001/12/24 (Mon) -> 2001/12/25 (Tue) 
2001/12/26 (Wed) -> 2001/12/26 (Wed) 
2001/12/27 (Thu) -> 2001/12/29 (Sat) 
2001/12/28 (Fri) -> 2001/12/31 (Mon) 
2001/12/31 (Mon) -> 2002/01/01 (Tue) 
2002/01/02 (Wed) -> 2002/01/02 (Wed) 
2002/01/03 (Thu) -> 2002/01/05 (Sat) 
> x1 <- dateSeq("2001/12/20", by = "bizdays", len = 8, holidays = "NYSEC")
> pp(x1, dateWarp(x1, "+1 bizdays@NYSEC"))
2001/12/20 (Thu) -> 2001/12/21 (Fri) 
2001/12/21 (Fri) -> 2001/12/24 (Mon) 
2001/12/24 (Mon) -> 2001/12/26 (Wed) 
2001/12/26 (Wed) -> 2001/12/27 (Thu) 
2001/12/27 (Thu) -> 2001/12/28 (Fri) 
2001/12/28 (Fri) -> 2001/12/31 (Mon) 
2001/12/31 (Mon) -> 2002/01/02 (Wed) 
2002/01/02 (Wed) -> 2002/01/03 (Thu) 
> pp(x1, dateWarp(x1, "+5 bizdays@NYSEC"))
2001/12/20 (Thu) -> 2001/12/28 (Fri) 
2001/12/21 (Fri) -> 2001/12/31 (Mon) 
2001/12/24 (Mon) -> 2002/01/02 (Wed) 
2001/12/26 (Wed) -> 2002/01/03 (Thu) 
2001/12/27 (Thu) -> 2002/01/04 (Fri) 
2001/12/28 (Fri) -> 2002/01/07 (Mon) 
2001/12/31 (Mon) -> 2002/01/08 (Tue) 
2002/01/02 (Wed) -> 2002/01/09 (Wed) 
> pp(x1, dateWarp(x1, "-5 bizdays@NYSEC"))
2001/12/20 (Thu) -> 2001/12/13 (Thu) 
2001/12/21 (Fri) -> 2001/12/14 (Fri) 
2001/12/24 (Mon) -> 2001/12/17 (Mon) 
2001/12/26 (Wed) -> 2001/12/18 (Tue) 
2001/12/27 (Thu) -> 2001/12/19 (Wed) 
2001/12/28 (Fri) -> 2001/12/20 (Thu) 
2001/12/31 (Mon) -> 2001/12/21 (Fri) 
2002/01/02 (Wed) -> 2001/12/24 (Mon) 
> pp(x1, dateWarp(x1, "-1 bizdays@NYSEC"))
2001/12/20 (Thu) -> 2001/12/19 (Wed) 
2001/12/21 (Fri) -> 2001/12/20 (Thu) 
2001/12/24 (Mon) -> 2001/12/21 (Fri) 
2001/12/26 (Wed) -> 2001/12/24 (Mon) 
2001/12/27 (Thu) -> 2001/12/26 (Wed) 
2001/12/28 (Fri) -> 2001/12/27 (Thu) 
2001/12/31 (Mon) -> 2001/12/28 (Fri) 
2002/01/02 (Wed) -> 2001/12/31 (Mon) 
> pp(x1, dateWarp(x1, "-1 bizdays"))
2001/12/20 (Thu) -> 2001/12/19 (Wed) 
2001/12/21 (Fri) -> 2001/12/20 (Thu) 
2001/12/24 (Mon) -> 2001/12/21 (Fri) 
2001/12/26 (Wed) -> 2001/12/25 (Tue) 
2001/12/27 (Thu) -> 2001/12/26 (Wed) 
2001/12/28 (Fri) -> 2001/12/27 (Thu) 
2001/12/31 (Mon) -> 2001/12/28 (Fri) 
2002/01/02 (Wed) -> 2002/01/01 (Tue) 
> pp(x1, dateWarp(x1, "+1 bizdays"))
2001/12/20 (Thu) -> 2001/12/21 (Fri) 
2001/12/21 (Fri) -> 2001/12/24 (Mon) 
2001/12/24 (Mon) -> 2001/12/25 (Tue) 
2001/12/26 (Wed) -> 2001/12/27 (Thu) 
2001/12/27 (Thu) -> 2001/12/28 (Fri) 
2001/12/28 (Fri) -> 2001/12/31 (Mon) 
2001/12/31 (Mon) -> 2002/01/01 (Tue) 
2002/01/02 (Wed) -> 2002/01/03 (Thu) 
> pp(x1, dateWarp(x1, "-1", by="bizdays"))
2001/12/20 (Thu) -> 2001/12/19 (Wed) 
2001/12/21 (Fri) -> 2001/12/20 (Thu) 
2001/12/24 (Mon) -> 2001/12/21 (Fri) 
2001/12/26 (Wed) -> 2001/12/25 (Tue) 
2001/12/27 (Thu) -> 2001/12/26 (Wed) 
2001/12/28 (Fri) -> 2001/12/27 (Thu) 
2001/12/31 (Mon) -> 2001/12/28 (Fri) 
2002/01/02 (Wed) -> 2002/01/01 (Tue) 
> pp(x1, dateWarp(x1, "+1", by="bizdays"))
2001/12/20 (Thu) -> 2001/12/21 (Fri) 
2001/12/21 (Fri) -> 2001/12/24 (Mon) 
2001/12/24 (Mon) -> 2001/12/25 (Tue) 
2001/12/26 (Wed) -> 2001/12/27 (Thu) 
2001/12/27 (Thu) -> 2001/12/28 (Fri) 
2001/12/28 (Fri) -> 2001/12/31 (Mon) 
2001/12/31 (Mon) -> 2002/01/01 (Tue) 
2002/01/02 (Wed) -> 2002/01/03 (Thu) 
> pp(x1, dateWarp(x1, "+1 days"))
2001/12/20 (Thu) -> 2001/12/21 (Fri) 
2001/12/21 (Fri) -> 2001/12/22 (Sat) 
2001/12/24 (Mon) -> 2001/12/25 (Tue) 
2001/12/26 (Wed) -> 2001/12/27 (Thu) 
2001/12/27 (Thu) -> 2001/12/28 (Fri) 
2001/12/28 (Fri) -> 2001/12/29 (Sat) 
2001/12/31 (Mon) -> 2002/01/01 (Tue) 
2002/01/02 (Wed) -> 2002/01/03 (Thu) 
> pp(x1, dateWarp(x1, "-1 days"))
2001/12/20 (Thu) -> 2001/12/19 (Wed) 
2001/12/21 (Fri) -> 2001/12/20 (Thu) 
2001/12/24 (Mon) -> 2001/12/23 (Sun) 
2001/12/26 (Wed) -> 2001/12/25 (Tue) 
2001/12/27 (Thu) -> 2001/12/26 (Wed) 
2001/12/28 (Fri) -> 2001/12/27 (Thu) 
2001/12/31 (Mon) -> 2001/12/30 (Sun) 
2002/01/02 (Wed) -> 2002/01/01 (Tue) 
> pp(dateWarp("2004/12/23", 0:6, by="days"))
2004/12/23 (Thu)     
2004/12/24 (Fri)                     
2004/12/25 (Sat)                     
2004/12/26 (Sun)                     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
> pp(dateWarp("2004/12/23", 0:6, by="bizdays"))
2004/12/23 (Thu)     
2004/12/24 (Fri)                     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
2004/12/30 (Thu)                     
2004/12/31 (Fri)                     
> pp(dateWarp("2004/12/23", 0:6, by="bizdays@NYSEC"))
2004/12/23 (Thu)     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
2004/12/30 (Thu)                     
2004/12/31 (Fri)                     
2005/01/03 (Mon)                     
> pp(dateWarp("2004/12/23", "+3 days"))
2004/12/26 (Sun)     
> pp(dateWarp("2004/12/23", "+3 bizdays"))
2004/12/28 (Tue)     
> pp(dateWarp("2004/12/23", "+3 bizdays@NYSEC"))
2004/12/29 (Wed)     
> pp(dateWarp("2004/12/23", list(0:6), by="bizdays@NYSEC"))
2004/12/23 (Thu)     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
2004/12/30 (Thu)                     
2004/12/31 (Fri)                     
2005/01/03 (Mon)                     
> pp(dateWarp("2004/12/23", list(shift=0:6), by="bizdays@NYSEC"))
2004/12/23 (Thu)     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
2004/12/30 (Thu)                     
2004/12/31 (Fri)                     
2005/01/03 (Mon)                     
> pp(dateWarp("2004/12/23", list(shift=as.character(0:6)), by="bizdays@NYSEC"))
2004/12/23 (Thu)     
2004/12/27 (Mon)                     
2004/12/28 (Tue)                     
2004/12/29 (Wed)                     
2004/12/30 (Thu)                     
2004/12/31 (Fri)                     
2005/01/03 (Mon)                     
> d <- c("2000/07/01", "2000/08/01", "2000/09/01", "2000/10/01", "2000/11/01")
> pp(d, dateWarp(d, hol="NYSEC", list(shift=list(k.by=1, by="months"), shift=list(k.by=-1, by="bizdays"))))
2000/07/01 (Sat) -> 2000/07/31 (Mon) 
2000/08/01 (Tue) -> 2000/08/31 (Thu) 
2000/09/01 (Fri) -> 2000/09/29 (Fri) 
2000/10/01 (Sun) -> 2000/10/31 (Tue) 
2000/11/01 (Wed) -> 2000/11/30 (Thu) 
> pp(d, dateWarp(d, hol="NYSEC", list(shift=list(1, by="months"), shift=list(-1, by="bizdays"))))
2000/07/01 (Sat) -> 2000/07/31 (Mon) 
2000/08/01 (Tue) -> 2000/08/31 (Thu) 
2000/09/01 (Fri) -> 2000/09/29 (Fri) 
2000/10/01 (Sun) -> 2000/10/31 (Tue) 
2000/11/01 (Wed) -> 2000/11/30 (Thu) 
> pp(d, dateWarp(d, hol="NYSEC", by="bizdays", list(last=list(of="months"))))
#@ ignore-linebreaks
Error in dateWarp.default(d, hol = "NYSEC", by = "bizdays", list(last = list(of = "months"))) : 
  names of lists must be 'align' or 'shift'.
> pp(dateWarp("2006/10/04", list("-1 months")))
2006/09/04 (Mon)     
> # The following checksum agrees with S-PLUS.
> allDates <- dateSeq(as.Date("1980/1/1"), "2009/1/22")
> length(allDates)
[1] 10615
> sum(dateWarp(allDates, list(align = list(by = "bizdays"), shift = list(by = "bizdays")), holidays = "NYSEC") - allDates)
Time difference of 19181 days
> sum(allDates - dateWarp(allDates, list(align = list(by = "bizdays"), shift = list(by = "days", -5), shift = list(by = "bizdays")), holidays = "NYSEC"))
Time difference of 32078 days
> 
> # Check that class of result is class of argument
> class(dateWarp("2006/10/04", list("-1 months")))
[1] "character"
> class(dateWarp(as.Date("2006/10/04"), list("-1 months")))
[1] "Date"
> class(dateWarp(as.POSIXct("2006/10/04"), list("-1 months")))
[1] "POSIXct" "POSIXt" 
> class(dateWarp(as.POSIXlt("2006/10/04"), list("-1 months")))
[1] "POSIXlt" "POSIXt" 
> dateWarp(as.POSIXlt("2006/10/04"), list("-1 months"))
[1] "2006-09-04 EST"
> dateWarp(as.POSIXct("2006/10/04"), list("-1 months"))
[1] "2006-09-04 EST"
> dateWarp(as.Date("2006/10/04"), list("-1 months"))
[1] "2006-09-04"
> 
> 
> # Find option expiration dates in 2011
> yy <- 2011
> (d1 <- dateSeq(paste(yy, '-01-01', sep=''), len=12, by='months'))
 [1] "2011-01-01" "2011-02-01" "2011-03-01" "2011-04-01" "2011-05-01"
 [6] "2011-06-01" "2011-07-01" "2011-08-01" "2011-09-01" "2011-10-01"
[11] "2011-11-01" "2011-12-01"
> (d2 <- dateAlign(d1, by='months', dir=-1))
 [1] "2011-01-01" "2011-02-01" "2011-03-01" "2011-04-01" "2011-05-01"
 [6] "2011-06-01" "2011-07-01" "2011-08-01" "2011-09-01" "2011-10-01"
[11] "2011-11-01" "2011-12-01"
> (d3 <- dateAlign(d2, by='weeks', week.align=5))
 [1] "2011-01-07" "2011-02-04" "2011-03-04" "2011-04-01" "2011-05-06"
 [6] "2011-06-03" "2011-07-01" "2011-08-05" "2011-09-02" "2011-10-07"
[11] "2011-11-04" "2011-12-02"
> (d4 <- dateWarp(d3, 14, by='days'))
 [1] "2011-01-21" "2011-02-18" "2011-03-18" "2011-04-15" "2011-05-20"
 [6] "2011-06-17" "2011-07-15" "2011-08-19" "2011-09-16" "2011-10-21"
[11] "2011-11-18" "2011-12-16"
> (d5 <- dateAlign(d4, by='bizdays@NYSEC', dir=-1))
 [1] "2011-01-21" "2011-02-18" "2011-03-18" "2011-04-15" "2011-05-20"
 [6] "2011-06-17" "2011-07-15" "2011-08-19" "2011-09-16" "2011-10-21"
[11] "2011-11-18" "2011-12-16"
> 
> # Find option expiration dates that have been shifted because they would have
> # occured on a holiday
> yy <- 1990
> d1 <- dateSeq(paste(yy, '-01-01', sep=''), len=288, by='months')
> d2 <- dateAlign(d1, by='months', dir=-1)
> d3 <- dateAlign(d2, by='weeks', week.align=5)
> d4 <- dateWarp(d3, 14, by='days')
> d5 <- dateAlign(d4, by='bizdays@NYSEC', dir=-1)
> data.frame(holiday=d4, option.expiration=d5)[which(d4 != d5), ]
       holiday option.expiration
28  1992-04-17        1992-04-16
124 2000-04-21        2000-04-20
160 2003-04-18        2003-04-17
219 2008-03-21        2008-03-20
> 